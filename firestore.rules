rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // admins 컬렉션: 인증된 사용자만 읽기 가능
    match /admins/{email} {
      allow read: if request.auth != null;
      allow write: if false; // 쓰기는 콘솔에서만 가능
    }
    
    // ads 컬렉션: 
    // - 홈 화면: 모든 사용자가 읽을 수 있음 (광고는 공개 정보)
    // - 관리자 페이지: 관리자만 읽기 가능 (관리자 페이지는 관리자만 접근)
    // - 쓰기: 관리자만 가능
    match /ads/{adId} {
      // 읽기: 모든 사용자 (홈 화면에서 보여주기 위해)
      // 관리자 페이지는 앱 레벨에서 접근 제어하므로 여기서는 모든 사용자 허용
      allow read: if true;
      // 쓰기: 관리자만
      allow write: if request.auth != null && 
        exists(/databases/$(database)/documents/admins/$(request.auth.token.email));
    }
    
    // 기타 컬렉션은 필요에 따라 설정
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}

